"'Screen Audit Address' As screen":
    LoadingSpinner: =LoadingSpinner.Data
    OnVisible: |-
        =Reset(ComboBox4);
        
        Clear(AuditarEnderecos);
        
        UpdateContext({locCheckbox:false});
        
        ClearCollect(colUsuarios,ForAll(Filter(listUsuarios,Perfil.Value = "Estoquista"),'Nome Usuario'))

    "Gallery2 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        BorderThickness: =1
        Height: =466
        Items: =Distinct(collectionAuditoriaEnderecos,Local).Result
        Layout: =Layout.Vertical
        ShowNavigation: =true
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =112
        Width: =554
        X: =38
        Y: =304
        ZIndex: =1

        Button1 As button:
            BorderThickness: =1
            Fill: =RGBA(255, 255, 255, 1)
            Height: =90
            HoverFill: =Self.Fill
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =1
            RadiusBottomRight: =1
            RadiusTopLeft: =1
            RadiusTopRight: =1
            Size: =24
            Text: ="Botão"
            Width: =526
            X: =20
            Y: =13
            ZIndex: =1

        Title4 As label:
            Font: =Font.'Lato Black'
            Height: =36
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="LOCAL " & ThisItem.Result.Value
            VerticalAlign: =VerticalAlign.Top
            Width: =409
            X: =39
            Y: =40
            ZIndex: =2

        Checkbox1 As checkbox:
            CheckboxSize: =40
            Default: =locCheckbox
            DisplayMode: =If(Checkbox2.Value,DisplayMode.Disabled,DisplayMode.Edit)
            Height: =36
            OnCheck: =Collect(AuditarEnderecos,ThisItem.Result)
            OnSelect: =Select(Parent)
            OnUncheck: =RemoveIf(AuditarEnderecos,Value = ThisItem.Result.Value)
            Size: =21
            Text: =""
            Width: =45
            X: =482
            Y: =40
            ZIndex: =3

    ctnViewStockHeader_2 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(24, 56, 132, 1)
        Height: =70
        Width: =640
        ZIndex: =2

        lblHeaderTitle_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Open Sans Condensed'
            FontWeight: =FontWeight.Semibold
            Height: =70
            Size: =25
            Text: ="Selecionar Endereços"
            Width: =640
            ZIndex: =1

        Icon2_2 As icon.ArrowLeft:
            Color: =RGBA(255, 255, 255, 1)
            Height: =46
            Icon: =Icon.ArrowLeft
            OnSelect: =Navigate('Screen Audit Mount',ScreenTransition.UnCoverRight)
            X: =7
            Y: =12
            ZIndex: =3

    Checkbox2 As checkbox:
        CheckboxSize: =40
        Default: =locCheckbox
        DisplayMode: =
        Font: =Font.Lato
        Height: =37
        OnCheck: |-
            =UpdateContext({locCheckbox: true});
            
            ForAll(Collect(AuditarEnderecos,Gallery2.AllItems),Result)
        OnUncheck: |-
            =UpdateContext({locCheckbox:false});
            Clear(AuditarEnderecos)
        Size: =15
        Text: ="Selecionar Todos"
        Width: =200
        X: =392
        Y: =257
        ZIndex: =3

    Label3_1 As label:
        Align: =Align.Center
        Font: =Font.'Lato Black'
        FontWeight: =FontWeight.Semibold
        Height: =70
        Italic: =true
        Size: =22
        Text: ="Escolha os endereços abaixo e selecione o estoquista para gerar a auditoria."
        Width: =560
        X: =35
        Y: =128
        ZIndex: =4

    ComboBox4 As combobox:
        BorderThickness: =1
        DisplayFields: =["DisplayName","Email"]
        DisplayMode: =If(CountRows(AuditarEnderecos) > 0,DisplayMode.Edit, DisplayMode.Disabled)
        Font: =Font.Lato
        Height: =74
        InputTextPlaceholder: ="Selecionar Estoquista"
        Items: =colUsuarios
        Reset: =true
        SearchFields: =["DisplayName"]
        SearchItems: =Search(colUsuarios,ComboBox4.SearchText,"DisplayName")
        SelectMultiple: =false
        Size: =21
        Template: =ListItemTemplate.Double
        Width: =529
        X: =55
        Y: =803
        ZIndex: =5

    Button2 As button:
        DisplayMode: =If(CountRows(AuditarEnderecos) > 0 And !IsBlank(ComboBox4.Selected),DisplayMode.Edit,DisplayMode.Disabled)
        Fill: =RGBA(24, 56, 132, 1)
        Font: =Font.Lato
        Height: =74
        OnSelect: |
            =// Gerar código especial para auditorias
            UpdateContext({
                locCodigoAuditoria: Upper(Left(GUID(),8))
            });
            
            // Criar registros na lista do Sharepoint a partir da coleção gerada
            ForAll(AuditarEnderecos,
                Patch(
                    listGerarAuditorias,{
                        'Codigo Auditoria': locCodigoAuditoria,
                        Local: If(IsBlank(ThisRecord.Value),ThisRecord.Result.Value,ThisRecord.Value),
                        Estoquista: ComboBox4.Selected.DisplayName,
                        'ID Estoquista': Lower(ComboBox4.Selected.Email)
                    }
                )
            );
            
            Navigate('Screen Notifications',ScreenTransition.CoverRight,{passCodAuditoria: locCodigoAuditoria})
        RadiusBottomLeft: =200
        RadiusBottomRight: =200
        RadiusTopLeft: =200
        RadiusTopRight: =200
        Size: =24
        Text: ="Gerar Auditoria"
        Width: =378
        X: =131
        Y: =917
        ZIndex: =6

    Label7 As label:
        Font: =Font.Lato
        Height: =37
        Italic: =true
        Size: =15
        Text: |-
            ="N° de Endereços: " & CountRows(Gallery2.AllItems)
        Width: =257
        X: =38
        Y: =267
        ZIndex: =7

